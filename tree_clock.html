<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tree Clock</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            background: #111111;
            overflow: hidden;
        }
    </style>
</head>

<body>
    <svg id="tree-svg" width="100%" height="100vh" preserveAspectRatio="xMidYMid meet">
        <g id="tree-container"></g>
    </svg>

    <script src="tree_clock.js"></script>
    <script>
        // Render function to create the tree
        function renderTree() {
            const svg = document.getElementById('tree-svg');
            const container = document.getElementById('tree-container');

            // Set viewBox to make SVG responsive
            const width = window.innerWidth;
            const height = window.innerHeight;
            svg.setAttribute('viewBox', `0 0 ${width} ${height}`);

            // tree root
            const global_start = {
                x: width / 2,
                y: height / 2
            };

            const factors = {
                "hours": [2, 2, 2, 3],
                "minutes": [2, 2, 3, 5],
                "seconds": [2, 2, 3, 5]
            };
            // Custom colors for each layer
            const colors = {
                // Hour colors - emerald green shades from darker to lighter
                "hours": ['#0B4D2C', '#137547', '#1B9C5F', '#23C277'],
                "minutes": ['#8B0000', '#B22222', '#DC143C', '#FF4500'],
                "seconds": ['#000080', '#0000CD', '#4169E1', '#1E90FF'],
            };
            const angles = {
                "hours": 0,
                "minutes": 2 * Math.PI / 3,
                "seconds": 4 * Math.PI / 3
            }
            const lines_num = {
                "hours": 24,
                "minutes": 60,
                "seconds": 60
            }
            const total_lines = Object.values(lines_num).reduce((acc, curr) => acc + curr, 0);

            const lines = [];

            const time_divisions = ['hours', 'minutes', 'seconds'];
            let start_angle = 0;
            for (const key of time_divisions) {
                const sector_part = lines_num[key] / total_lines;
                const end_angle = start_angle + 2 * Math.PI * sector_part;
                const branch_height = Math.min(width, height) * 0.1;

                lines.push(...tree_clock(
                    global_start,
                    start_angle,
                    end_angle,
                    branch_height,
                    factors[key]
                ).map(line => [...line, colors[key][line[2] % colors[key].length]])
                );

                start_angle = end_angle;
            }

            // Generate SVG markup
            const svgContent = lines.map(line => {
                const [start, end, layer, lineNumber, color] = line;
                return `<line 
                    x1="${start.x}" 
                    y1="${start.y}" 
                    x2="${end.x}" 
                    y2="${end.y}" 
                    stroke="${color}" 
                    stroke-width="${1}" 
                    stroke-linecap="round"
                    data-layer="${layer}"
                    data-line-number="${lineNumber}" />`;
            }).join('\n');

            // Update SVG content
            container.innerHTML = svgContent;
        }

        // Initial render and handle window resize
        window.addEventListener('load', renderTree);
        window.addEventListener('resize', renderTree);
    </script>
</body>

</html>